<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>杭电赏花网</title>
  </head>
  <link rel="stylesheet" href="./css/normalize.css" />
  <link rel="stylesheet" href="./css/index.css" />
  <link rel="stylesheet" href="./css/more.css" />
  <link rel="stylesheet" href="./css/form.css" />
  <link rel="stylesheet" href="./css/list.css" />
  <link rel="stylesheet" href="./css/detail.css" />
  <link rel="stylesheet" href="./assets/jquery.easy_slides.css" />
  <body>
    <div class="container">
      <header class="header">
        <h1>杭电赏花网</h1>
      </header>
      <nav class="navigator">
        <ul>
          <li>
            <a href="#/">首页</a>
          </li>
          <li>
            <a href="#/list">赏花信息</a>
          </li>
          <li>
            <a href="#/form">新增赏花信息</a>
          </li>
          <li>
            <a href="#/more">更多链接</a>
          </li>
        </ul>
      </nav>
      <main id="content"></main>

      <div class="top">top</div>
    </div>
  </body>
</html>

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.js"></script>
<script src="./assets/jquery.easy_slides.js"></script>
<script src="./js/normalize.js"></script>
<script src="./js/form.js"></script>

<script>
  const navLinks = document.querySelectorAll("a");
  const contentArea = document.getElementById("content");

  function renderMain() {
    const contentMain = `
          <div class="pictures">
          <div class="slider slider_one_big_picture">
            <img src="./assets/flowers/梅花.png" alt="" />
            <img src="./assets/flowers/粉杏.png" alt="" />
            <img src="./assets/flowers/郁金香.png" alt="" />
            <div class="next_button"></div>
            <div class="prev_button"></div>
            <div class="nav_indicators"></div>
          </div>
        </div>

        <div class="card">
          <div class="card-item flower-information">
            <h2>杭电校内赏花信息</h2>
            <ul>
              <li><a href="#/list/1">花名：梅花，分布地点：8教实验楼门前，飞碟体育馆周边</a></li>
              <li><a href="#/list/2">花名：梅花，分布地点：8教实验楼门前，飞碟体育馆周边</a></li>
              <li><a href="#/list/3">花名：梅花，分布地点：8教实验楼门前，飞碟体育馆周边</a></li>
              <div class="more-information"><a href="#/list">更多信息</a></div>
            </ul>
          </div>

          <div class="card-item more-link">
            <h2>更多关于花的网站</h2>
            <ul>
              <li><a href="http://www.huafensi.com/" target="_blank">花粉丝：花卉查询网</a></li>
              <li><a href="http://www.nahuayuan.com/" target="_blank">那花园--花卉第一网站！</a></li>
              <li><a href="https://www.yhzhishi.com/" target="_blank">养花知识网</a></li>
            </ul>
            <div class="more-information"><a href="#/more">更多信息</a></div>
          </div>
        </div>`;
    return contentMain;
  }
  function renderMore() {
    return `
        <h2>更多关于花的网站</h2>
        <ul class="list-link">
          <li>
            <div class="brief">简介：</div>
            <a href="http://www.huafensi.com/" target="_blank">花粉丝：花卉查询网</a>
          </li>
          <li>
            <div class="brief">简介：</div>
            <a href="http://www.nahuayuan.com/" target="_blank">那花园--花卉第一网站！</a>
          </li>
          <li>
            <div class="brief">简介：</div>
            <a href="https://www.yhzhishi.com/" target="_blank">养花知识网</a>
          </li>
        </ul>`;
  }
  function renderForm() {
    return `
        <h2 class="title">新增赏花信息</h2>
        <form action="" method="post">
          <div class="form-item">
            <label for="flower-name">花名：</label>
            <input type="text" id="flower-name" name="flower-name" />
          </div>
          <div class="form-item">
            <label for="flower-alias">别名：</label>
            <input type="text" id="flower-alias" name="flower-alias" />
          </div>
          <div class="form-item">
            <label for="flower-scientific-name">学名：</label>
            <input type="text" id="flower-scientific-name" name="flower-scientific-name" />
          </div>
          <div class="form-item">
            <label for="flower-family">花科：</label>
            <input type="text" id="flower-family" name="flower-family" />
          </div>
          <div class="form-item">
            <label for="flower-origin">原产地：</label>
            <select name="flower-origin" id="flower-origin">
              <option value="亚洲">亚洲</option>
              <option value="欧洲">欧洲</option>
              <option value="非洲">非洲</option>
              <option value="北美洲">北美洲</option>
              <option value="南美洲">南美洲</option>
              <option value="大洋洲">大洋洲</option>
              <option value="南极洲">南极洲</option>
            </select>
          </div>
          <div class="form-item">
            <label for="flower-flowering-period">花期：</label>
            <input type="radio" name="flower-flowering-period" value="春" />春
            <input type="radio" name="flower-flowering-period" value="夏" />夏
            <input type="radio" name="flower-flowering-period" value="秋" />秋
            <input type="radio" name="flower-flowering-period" value="冬" />冬
          </div>
          <div class="form-item">
            <label for="flower-color">花色：</label>
            <input type="checkbox" name="flower-color" value="红色" />红色
            <input type="checkbox" name="flower-color" value="蓝色" />蓝色
            <input type="checkbox" name="flower-color" value="绿色" />绿色
            <input type="checkbox" name="flower-color" value="黄色" />黄色
            <input type="checkbox" name="flower-color" value="紫色" />紫色
            <input type="checkbox" name="flower-color" value="白色" />白色
            <input type="checkbox" name="flower-color" value="黑色" />黑色
            <input type="checkbox" name="flower-color" value="橙色" />橙色
            <input type="checkbox" name="flower-color" value="粉色" />粉色
            <input type="checkbox" name="flower-color" value="棕色" />棕色
            <input type="checkbox" name="flower-color" value="灰色" />灰色
            <input type="checkbox" name="flower-color" value="金色" />金色
            <input type="checkbox" name="flower-color" value="银色" />银色
          </div>
          <div class="form-item">
            <label for="flower-growth-environment">生长环境：</label>
            <input type="text" id="flower-growth-environment" name="flower-growth-environment" />
          </div>
          <div class="form-item">
            <label for="flower-distribution">校园分布地点：</label>
            <input type="text" id="flower-distribution" name="flower-distribution" />
          </div>
          <div class="form-item">
            <label for="flower-description">特点描述：</label>
            <textarea name="flower-description" id="flower-description" cols="30" rows="10"></textarea>
          </div>
          <div class="form-item">
            <label for="flower-image">花朵图片（大小1MB以下）：</label>
            <input accept="image/jpeg, image/png" type="file" id="flower-image" name="flower-image" />
          </div>
          <div class="form-item">
            <input type="submit" value="提交" />
          </div>
        </form>`;
  }
  function renderList() {
    return `        <h2>杭电校内赏花信息</h2>
        <ul class="list-flowers">
          <li>
            <a href="#/list/1"
              ><img
                src="../assets/flowers/梅花.png"
                alt="梅花"
                width="100"
                height="60"
              />花名：梅花，分布地点：8教实验楼门前，飞碟体育馆周边</a
            >
          </li>
          <li>
            <a href="#/list/2"
              ><img
                src="../assets/flowers/梅花.png"
                alt="梅花"
                width="100"
                height="60"
              />花名：梅花，分布地点：8教实验楼门前，飞碟体育馆周边</a
            >
          </li>
          <li>
            <a href="#/list/3"
              ><img
                src="../assets/flowers/梅花.png"
                alt="梅花"
                width="100"
                height="60"
              />花名：梅花，分布地点：8教实验楼门前，飞碟体育馆周边</a
            >
          </li>
        </ul>`;
  }
  function renderDetail(id) {}
  // 定义路由配置
  const routes = [
    { path: "/", component: renderMain() },
    { path: "/more", component: renderMore() },
    { path: "/list", component: renderList() },
    { path: "/form", component: renderForm() },
    { path: "/list/:id", component: renderDetail },
  ];

  // 添加hashchange事件监听器
  window.addEventListener("hashchange", handleRouteChange);

  // 处理路由变化
  function handleRouteChange() {
    const currentHash = window.location.hash.slice(1) || "/"; // 去除'#'字符，添加默认路由

    // 查找匹配的路由配置
    const route = routes.find((r) => {
      if (r.path.includes(":id")) {
        const regex = new RegExp(r.path.replace(/:[^\s/]+/, "([\\w-]+)"));
        return currentHash.match(regex);
      }
      return currentHash === r.path;
    });

    if (route) {
      if (typeof route.component === "function") {
        // 如果页面组件是函数，调用它并传递参数
        const params = getParams(currentHash, route.path);
        contentArea.innerHTML = route.component(...params);
      } else {
        contentArea.innerHTML = route.component;
      }
    } else {
      contentArea.innerHTML = "<h1>404 - 页面未找到</h1>";
    }

    updateJS(route);
    //根据路由更新 js 事件注册函数
    function updateJS(route) {
      if (route.path === "/") {
        $(".slider_one_big_picture").EasySlides({
          autoplay: true,
          timeout: 3000,
          loop: true,
          show: 3,
        });
      } else if (route.path === "/form") {
        initForm();
      }
    }
  }

  // 初始状态下处理路由
  handleRouteChange();

  // 阻止链接默认行为，使用路由处理导航
  navLinks.forEach((link) => {
    link.addEventListener("click", (e) => {
      e.preventDefault();
      if (e.target.tagName === "A") {
        window.location.hash = e.target.getAttribute("href");
      }
    });
  });

  // 获取路由参数
  function getParams(hash, path) {
    const hashParts = hash.split("/");
    const pathParts = path.split("/");
    const params = [];

    pathParts.forEach((part, i) => {
      if (part.startsWith(":")) {
        params.push(hashParts[i] || null);
      }
    });

    return params;
  }
</script>
